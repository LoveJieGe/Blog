@{
    ViewBag.Title = ViewBag.Year+"年"+ ViewBag.Month+"月随笔归档 - "+ ViewBag.User.UserName + " - 海·星の博客";
    string newArticle = Guid.NewGuid().ToString(),
        personTag = Guid.NewGuid().ToString(),
        archive = Guid.NewGuid().ToString();
}
@section styles{
    @Styles.Render("~/content/default")
}
<div class="hx-container blog-view">
    <div class="d-flex">
        <aside class="d-flex flex-column blog-aside">
            <div class="d-inline-flex align-items-center mt-2 p-3 hx-white-container hx-aside-title">
                <div class="user-md-avater mr-2">
                    <a>
                        <img src="~/images/avatar.png" />
                    </a>
                </div>
                <div class="mr-1">@(string.IsNullOrEmpty(ViewBag.User.NickName) ? ViewBag.User.UserName : ViewBag.User.NickName)</div>
                @if (UserContext.LoginUser == null || UserContext.LoginUser.Id != ViewBag.User.Id)
                {
                    <div class="ml-auto mr-2">
                        <button type="button" class="btn btn-outline-secondary btn-sm">关注</button>
                    </div>
                }
            </div>
            <div class="d-inline-flex justify-content-around  mb-1  p-3 hx-white-container">
                <div class="d-flex flex-column">
                    <span>园龄</span>
                    <span>100</span>
                </div>
                <div class="d-flex flex-column">
                    <span>粉丝</span>
                    <span>100</span>
                </div>
                <div class="d-flex flex-column">
                    <span>关注</span>
                    <span>100</span>
                </div>
                <div class="d-flex flex-column">
                    <span>访问</span>
                    <span>100</span>
                </div>
            </div>
            <div id="@newArticle" class="card my-1" hidden>
            </div>
            <div id="@personTag" class="card my-1" hidden>
            </div>
            <div id="@archive" class="card my-1" hidden>
            </div>
        </aside>
        <div class="flex-fill flex-column mt-2 ml-3 py-3 px-4 hx-white-container">
            <div class="d-flex">
                <div>
                    全部文章
                </div>
                <span>&nbsp;&nbsp;>&nbsp;&nbsp;</span>
                <div>@(ViewBag.Year + "年" + ViewBag.Month + "月")</div>
            </div>
            <div class="d-flex hx-light-content">
                @if (ViewBag.BlogList != null)
                {
                    foreach (HxBlogs.Model.Blog blog in ViewBag.BlogList)
                    {
                        <div>@blog.Title</div>
                    }
                }
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        $(function () {
            var $newArticle = $('#@newArticle'),
                $personTag = $('#@personTag'),
                $archive = $('#@archive');
            HxCore.ajax('/article/@ViewBag.User.UserName/side/loadarticle', {
                success(data) {
                    console.log(1)
                    $newArticle.html(data);
                    $newArticle.removeAttr('hidden');
                },
                failure() {
                }
            });
            HxCore.ajax('/article/@ViewBag.User.UserName/side/loadtag', {
                success(data) {
                    console.log(12);
                    $personTag.html(data);
                    $personTag.removeAttr('hidden');
                    
                    $('.hx-collapsed:last-child').on('shown.bs.collapse', function () {
                        $personTag.children('.card-footer').remove();
                    })
                },
                failure() {
                }
            });
            HxCore.ajax('/article/@ViewBag.User.UserName/side/loadarchive', {
                success(data) {
                    console.log(123);
                    $archive.html(data);
                    $archive.removeAttr('hidden');
                },
                failure() {
                }
                });
            });
    </script>
}
